exports.id = "main";
exports.modules = {

/***/ "./src/server/server.js":
/*!******************************!*\
  !*** ./src/server/server.js ***!
  \******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime/regenerator */ \"@babel/runtime/regenerator\");\n/* harmony import */ var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime/helpers/asyncToGenerator */ \"@babel/runtime/helpers/asyncToGenerator\");\n/* harmony import */ var _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _dapp_src_contracts_FlightSuretyApp_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../dapp/src/contracts/FlightSuretyApp.json */ \"./src/dapp/src/contracts/FlightSuretyApp.json\");\nvar _dapp_src_contracts_FlightSuretyApp_json__WEBPACK_IMPORTED_MODULE_2___namespace = /*#__PURE__*/__webpack_require__.t(/*! ../dapp/src/contracts/FlightSuretyApp.json */ \"./src/dapp/src/contracts/FlightSuretyApp.json\", 1);\n/* harmony import */ var _config_json__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config.json */ \"./src/server/config.json\");\nvar _config_json__WEBPACK_IMPORTED_MODULE_3___namespace = /*#__PURE__*/__webpack_require__.t(/*! ./config.json */ \"./src/server/config.json\", 1);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var web3__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! web3 */ \"web3\");\n/* harmony import */ var web3__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(web3__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! bignumber.js */ \"bignumber.js\");\n/* harmony import */ var bignumber_js__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(bignumber_js__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\nvar config = _config_json__WEBPACK_IMPORTED_MODULE_3__['localhost'];\nvar web3 = new web3__WEBPACK_IMPORTED_MODULE_5___default.a(new web3__WEBPACK_IMPORTED_MODULE_5___default.a.providers.WebsocketProvider(config.url.replace('https', 'wss')));\ninit();\nvar flightSuretyApp = new web3.eth.Contract(_dapp_src_contracts_FlightSuretyApp_json__WEBPACK_IMPORTED_MODULE_2__.abi, config.appAddress);\nvar oracles = [];\n\nfunction init() {\n  return _init.apply(this, arguments);\n}\n\nfunction _init() {\n  _init = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee() {\n    var accounts, NUMBER_OF_ORACLES;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return web3.eth.getAccounts();\n\n          case 2:\n            accounts = _context.sent;\n            NUMBER_OF_ORACLES = 40;\n            registerOracles(accounts.slice(1, NUMBER_OF_ORACLES + 1));\n            flightSuretyApp.events.OracleRequest({\n              fromBlock: 0\n            }, function (error, event) {\n              if (error) return console.log(error);\n              if (!event.returnValues) return console.error(\"No returnValues\");\n              respondToFetchFlightStatus(event.returnValues.index, event.returnValues.airline, event.returnValues.flight, event.returnValues.timestamp);\n            });\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _init.apply(this, arguments);\n}\n\nfunction registerOracles(_x) {\n  return _registerOracles.apply(this, arguments);\n}\n\nfunction _registerOracles() {\n  _registerOracles = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(oracleAccounts) {\n    var fee, STATUS_CODES, i, address, statusCode, indexes;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return flightSuretyApp.methods.REGISTRATION_FEE().call();\n\n          case 2:\n            fee = _context2.sent;\n            STATUS_CODES = [0, 10, 20, 30, 40, 50];\n            i = 0;\n\n          case 5:\n            if (!(i < oracleAccounts.length)) {\n              _context2.next = 18;\n              break;\n            }\n\n            address = oracleAccounts[i];\n            statusCode = STATUS_CODES[Math.floor(Math.random() * STATUS_CODES.length)];\n            _context2.next = 10;\n            return flightSuretyApp.methods.registerOracle().send({\n              from: address,\n              value: fee,\n              gas: 3000000\n            });\n\n          case 10:\n            _context2.next = 12;\n            return flightSuretyApp.methods.getMyIndexes().call({\n              from: address\n            });\n\n          case 12:\n            indexes = _context2.sent;\n            oracles.push({\n              address: address,\n              indexes: indexes,\n              statusCode: statusCode\n            });\n            console.log({\n              address: address,\n              indexes: indexes,\n              statusCode: statusCode\n            });\n\n          case 15:\n            i++;\n            _context2.next = 5;\n            break;\n\n          case 18:\n            console.log(\"\".concat(oracles.length, \" Oracles Registered\"));\n\n          case 19:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _registerOracles.apply(this, arguments);\n}\n\nfunction respondToFetchFlightStatus(_x2, _x3, _x4, _x5) {\n  return _respondToFetchFlightStatus.apply(this, arguments);\n}\n\nfunction _respondToFetchFlightStatus() {\n  _respondToFetchFlightStatus = _babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1___default()( /*#__PURE__*/_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee3(index, airline, flight, timestamp) {\n    var relevantOracles;\n    return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!(oracles.length === 0)) {\n              _context3.next = 2;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 2:\n            console.log(\"New request ************************\");\n            console.log(index, airline, flight, timestamp);\n            relevantOracles = [];\n            oracles.forEach(function (oracle) {\n              if (bignumber_js__WEBPACK_IMPORTED_MODULE_6___default()(oracle.indexes[0]).isEqualTo(index)) relevantOracles.push(oracle);\n              if (bignumber_js__WEBPACK_IMPORTED_MODULE_6___default()(oracle.indexes[1]).isEqualTo(index)) relevantOracles.push(oracle);\n              if (bignumber_js__WEBPACK_IMPORTED_MODULE_6___default()(oracle.indexes[2]).isEqualTo(index)) relevantOracles.push(oracle);\n            });\n            console.log(\"\".concat(relevantOracles.length, \" Matching Oracles will respond\"));\n            relevantOracles.forEach(function (oracle) {\n              flightSuretyApp.methods.submitOracleResponse(index, airline, flight, timestamp, oracle.statusCode).send({\n                from: oracle.address,\n                gas: 5555555\n              }).then(function () {\n                console.log(\"Oracle responded with \" + oracle.statusCode);\n              }).catch(function (err) {\n                return console.log(\"Oracle response rejected\");\n              });\n            });\n\n          case 8:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _respondToFetchFlightStatus.apply(this, arguments);\n}\n\nvar app = express__WEBPACK_IMPORTED_MODULE_4___default()();\napp.get('/api', function (req, res) {\n  res.send({\n    message: 'An API for use with your Dapp!'\n  });\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (app);\n\n//# sourceURL=webpack:///./src/server/server.js?");

/***/ })

};